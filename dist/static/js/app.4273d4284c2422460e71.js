webpackJsonp([1],{"5fbg":function(t,e){},COPj:function(t,e){},NHnr:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("/5sW"),s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("div",{staticClass:"title"},[this._v("键盘·钢琴师")]),this._v(" "),e("router-view")],1)},staticRenderFns:[]};var n=r("VU/8")({name:"App"},s,!1,function(t){r("S0ZQ")},null,null).exports,a=r("/ocq");window.AudioContext=window.AudioContext||window.webkitAudioContext;var o=new AudioContext;function c(t){var e=t,r=o.createOscillator(),i=o.createGain();r.connect(i),i.connect(o.destination),r.type="square",r.frequency.value=e,i.gain.setTargetAtTime(0,o.currentTime,.2),i.gain.setTargetAtTime(1,o.currentTime+1,.2),r.start(o.currentTime),r.stop(o.currentTime+1)}var h={data:function(){return{activeKey:""}},props:{letter:{type:Object,default:function(){return{show:"A",voice:65}}},pressLetter:{type:String,default:"A"},watchPress:{type:Boolean,default:!1}},watch:{watchPress:function(){var t=this.pressLetter;this.pressOnKey(t)}},methods:{pressOnKey:function(t){this.pressLetter===this.letter.show&&this.twinkelKey()},twinkelKey:function(){var t=this;this.activeKey="active-key";setTimeout(function(){t.activeKey=""},300);c(this.letter.voice)}}},l={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"letter",class:this.activeKey},[this._v(this._s(this.letter.show))])])},staticRenderFns:[]};var u=r("VU/8")(h,l,!1,function(t){r("5fbg")},"data-v-0d906a88",null).exports,d=r("Zrlr"),f=r.n(d),v=r("wxAW"),w=r.n(v),p=function(){function t(e){f()(this,t),this.ctx=e.getContext("2d"),this.height=[],this.smallHeight=[],this.timer;for(var r=0;r<43;r++)this.smallHeight.push(0)}return w()(t,[{key:"initHeight",value:function(t){this.height=[];for(var e=0;e<43;e++){var r=Math.floor(t-100*Math.random());this.height.push(r)}}},{key:"drawOne",value:function(t,e,r){var i=this.ctx.createLinearGradient(0,0,0,350);i.addColorStop(0,"red"),i.addColorStop(.7,"yellow"),i.addColorStop(1,"green"),this.ctx.fillStyle=i,this.ctx.fillRect(t,400,15,-e),this.ctx.fillStyle="green",this.ctx.fillRect(t,400-r-40,15,10)}},{key:"drawAll",value:function(){this.ctx.clearRect(0,0,800,400);for(var t=0;t<43;t++){var e=15+18*t;this.drawOne(e,this.height[t],this.smallHeight[t])}}},{key:"heightChange",value:function(){var t=this;this.height.forEach(function(e,r){t.height[r]=e-8,t.smallHeight[r]=t.smallHeight[r]-5,t.smallHeight[r]<t.height[r]&&(t.smallHeight[r]=t.height[r]),t.smallHeight[r]<-50&&(t.smallHeight[r]=-50)})}},{key:"isAllHeightZero",value:function(){for(var t=0;t<this.smallHeight.length;t++)if(-50!=this.smallHeight[t])return!1;return!0}},{key:"drawFresh",value:function(t){cancelAnimationFrame(this.timer),this.initHeight(t);var e=this;this.timer=requestAnimationFrame(function t(){console.log(e.smallHeight),e.isAllHeightZero()?cancelAnimationFrame(e.timer):(e.heightChange(),e.drawAll(),e.timer=requestAnimationFrame(t))})}}]),t}(),m={data:function(){return{}},props:{drawParam:{type:Number,default:500},watchPress:{type:Boolean,default:!1}},watch:{watchPress:function(){this.draw.drawFresh(this.drawParam)}},components:{},mounted:function(){this.drawCans()},methods:{drawCans:function(){var t=this.$refs.cas;this.draw=new p(t)}}},g={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"canvasPanel"},[e("canvas",{ref:"cas",attrs:{width:"800px",height:"400px"}})])},staticRenderFns:[]};var y={data:function(){return{letters:[{show:"A",voice:261},{show:"S",voice:293},{show:"D",voice:329},{show:"F",voice:349},{show:"J",voice:392},{show:"K",voice:440},{show:"L",voice:493}],pressLetter:"",watchPress:!1}},components:{keyPress:u,canvasPanel:r("VU/8")(m,g,!1,function(t){r("COPj")},"data-v-8c810088",null).exports},created:function(){var t=this;document.onkeypress=function(e){t.pressLetter=e.key.toUpperCase(),t.letters.forEach(function(e){t.pressLetter==e.show&&(t.watchPress=!t.watchPress)})," "===t.pressLetter&&(t.watchPress=!t.watchPress,c(550))}},methods:{},computed:{drawParam:function(){var t=this,e=void 0;return this.letters.forEach(function(r){t.pressLetter==r.show&&(e=r.voice-100)}),e}}},P={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",[r("canvas-panel",{attrs:{drawParam:t.drawParam,watchPress:t.watchPress}})],1),t._v(" "),r("div",{staticClass:"letter-list"},t._l(t.letters,function(e){return r("div",[r("key-press",{attrs:{letter:e,watchPress:t.watchPress,pressLetter:t.pressLetter}})],1)}))])},staticRenderFns:[]};var x=r("VU/8")(y,P,!1,function(t){r("r9ty")},"data-v-7355c38f",null).exports;i.a.use(a.a);var A=new a.a({routes:[{path:"/",component:x}]});i.a.config.productionTip=!1,new i.a({el:"#app",router:A,render:function(t){return t(n)}})},S0ZQ:function(t,e){},r9ty:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.4273d4284c2422460e71.js.map